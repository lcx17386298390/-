<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../myCSS/search.css">
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://cdn.staticfile.org/vue/3.0.5/vue.global.js"></script>
    <script src="https://cdn.bootcss.com/jquery/3.5.0/jquery.js"></script>
    <title>搜索结果</title>
</head>
<body>
<div id="search">
    <div id="branch1" class="branch">
        <table class="searchTable">
            <tr>
                <th>航班号</th>
                <th>出发机场</th>
                <th>到达机场</th>
                <th>出发时间</th>
                <th>到达时间</th>
                <th>经济舱</th>
                <th>头等舱</th>
            </tr>
            <tr>
                <th id="number1"></th>
                <th id="originValue1"></th>
                <th id="destinationValue1"></th>
                <th id="departrueTime1"></th>
                <th id="arrivalTime1"></th>
                <th id="economySeat1"></th>
                <th id="firstSeat1"></th>
            </tr>
        </table>
        <button onclick="btn(1)" class="button">选购</button>
        <div id="buttonBuy1"></div>
    </div>
    <div id="branch2" class="branch">
        <table class="searchTable">
            <tr>
                <th>航班号</th>
                <th>出发机场</th>
                <th>到达机场</th>
                <th>出发时间</th>
                <th>到达时间</th>
                <th>经济舱</th>
                <th>头等舱</th>
            </tr>
            <tr>
                <th id="number2"></th>
                <th id="originValue2"></th>
                <th id="destinationValue2"></th>
                <th id="departrueTime2"></th>
                <th id="arrivalTime2"></th>
                <th id="economySeat2"></th>
                <th id="firstSeat2"></th>
            </tr>
        </table>
        <button onclick="btn(2)" class="button">选购</button>
    </div>
    <div id="branch3" class="branch">
        <table class="searchTable">
            <tr>
                <th>航班号</th>
                <th>出发机场</th>
                <th>到达机场</th>
                <th>出发时间</th>
                <th>到达时间</th>
                <th>经济舱</th>
                <th>头等舱</th>
            </tr>
            <tr>
                <th id="number3"></th>
                <th id="originValue3"></th>
                <th id="destinationValue3"></th>
                <th id="departrueTime3"></th>
                <th id="arrivalTime3"></th>
                <th id="economySeat3"></th>
                <th id="firstSeat3"></th>
            </tr>
        </table>
        <button onclick="btn(3)" class="button">选购</button>
    </div>
    <div id="branch4" class="branch">
        <table class="searchTable">
            <tr>
                <th>航班号</th>
                <th>出发机场</th>
                <th>到达机场</th>
                <th>出发时间</th>
                <th>到达时间</th>
                <th>经济舱</th>
                <th>头等舱</th>
            </tr>
            <tr>
                <th id="number4"></th>
                <th id="originValue4"></th>
                <th id="destinationValue4"></th>
                <th id="departrueTime4"></th>
                <th id="arrivalTime4"></th>
                <th id="4"></th>
                <th id="firstSeat4"></th>
            </tr>
        </table>
        <button onclick="btn(4)" class="button">选购</button>
    </div>
    <div id="branch5" class="branch">
        <table class="searchTable">
            <tr>
                <th>航班号</th>
                <th>出发机场</th>
                <th>到达机场</th>
                <th>出发时间</th>
                <th>到达时间</th>
                <th>经济舱</th>
                <th>头等舱</th>
            </tr>
            <tr>
                <th id="number5"></th>
                <th id="originValue5"></th>
                <th id="destinationValue5"></th>
                <th id="departrueTime5"></th>
                <th id="arrivalTime5"></th>
                <th id="economySeat5"></th>
                <th id="firstSeat5"></th>
            </tr>
        </table>
        <button onclick="btn(5)" class="button">选购</button>
    </div>
</div>
<script>
    const app = {
        data() {
            return {}
        },
        methods: {}
    }

    //航班号
    let number
    //出发地点
    let originValue
    //目的地
    let destinationValue
    //出发日期
    let departureDate
    //出发时间
    let departrueTime
    //到达日期
    let arrivalDate
    //到达时间
    let arrivalTime
    //乘客类型（暂时不用）
    let passengersType
    //机票价格
    let price
    //剩余座位
    let seat
    //返回的数据
    let resMes

    $(document).ready(
        function () {
            // let params = new URLSearchParams();
            axios.post("http://localhost:8080/search")
                .then(response => {
                    console.log(response)
                    resMes = response.data
                    let len = resMes.length;
                    for (let i = 1; i <= len; i++) {
                        document.getElementById("branch" + i).style.visibility = 'visible';
                    }
                    for (let i = 1; i <= len; i++) {
                        document.getElementById("number" + i).innerText = resMes[i - 1].number
                        document.getElementById("originValue" + i).innerText = resMes[i - 1].origin
                        document.getElementById("destinationValue" + i).innerText = resMes[i - 1].destination
                        document.getElementById("departrueTime" + i).innerText = resMes[i - 1].departureTime
                        document.getElementById("arrivalTime" + i).innerText = resMes[i - 1].arrivalTime
                        let economySeat = resMes[i - 1].economySeat
                        let firstSeat = resMes[i - 1].firstSeat
                        if(economySeat!==0){
                            document.getElementById("economySeat" + i).innerText = "有";
                        }else{
                            document.getElementById("economySeat" + i).innerText = "无";
                        }
                        if(firstSeat!==0){
                            document.getElementById("firstSeat" + i).innerText = "有";
                        }else{
                            document.getElementById("firstSeat" + i).innerText = "无";
                        }
                        // document.getElementById("economySeat" + i).innerText = resMes[i - 1].economySeat
                        // document.getElementById("economyPrice" + i).innerText = resMes[i - 1].economyPrice
                        // document.getElementById("firstSeat" + i).innerText = resMes[i - 1].firstSeat
                        // document.getElementById("firstPrice" + i).innerText = resMes[i - 1].firstPrice
                    }
                    // for(let i=1;i<=5;i++){
                    //     console.log(document.getElementById("number"+i).innerText)
                    //     if($('#number'+i).innerText==undefined||($('#number'+i).innerText=='')){
                    //         document.getElementById("branch"+i).style.visibility='hidden';
                    //     }
                    // }
                })
                .catch(error => {
                    alert("有错误")
                })
        }
    )

    function btn(i) {
        let number = resMes[i - 1].number
        // let params = new URLSearchParams()
        // //传入的是number航班号
        // params.append('number', number)
        // axios.post('http://localhost:8080/ticketBuyButton', params)
        //     .then(function (response) {
        //         console.log(response);
        //         if(response.data==="error"){
        //             alert("您已购买此航班或航班不存在")
        //         }else{
        //             alert("购买成功");
        //         }
        //     })
        //     .catch(error => {
        //         alert("有错误")
        //     })
        // window.document.location.href="http://localhost:8080/search?ticketNumber="+number
    }
</script>
</body>
</html>